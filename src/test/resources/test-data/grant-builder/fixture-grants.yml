# Fixture Grants Tests
# Tests that the correct grant builder class is selected for different grant types
# Reference: https://docs.snowflake.com/en/sql-reference/sql/grant-privilege

tests:
  # Permission Grants - should use SnowflakePermissionGrantBuilder
  - name: "SELECT on TABLE"
    grant:
      privilege: SELECT
      objectType: TABLE
      objectName: FOO.BAR.STAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder
  - name: "SELECT on TABLE"
    grant:
      privilege: select
      objectType: table
      objectName: FOO.BAR.STAR
      role: my_role
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "SELECT on TABLE with quoted names"
    grant:
      privilege: SELECT
      objectType: TABLE
      objectName: "\"foO\".\"bar-1@\".STAR"
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "SELECT on TABLE with partial quotes"
    grant:
      privilege: SELECT
      objectType: TABLE
      objectName: "\"foo\".BAR.STAR"
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on SCHEMA"
    grant:
      privilege: USAGE
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on DATABASE"
    grant:
      privilege: USAGE
      objectType: DATABASE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "SELECT on EXTERNAL_TABLE"
    grant:
      privilege: SELECT
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Ownership Grants - should use SnowflakeOwnershipGrantBuilder
  - name: "OWNERSHIP on SCHEMA"
    grant:
      privilege: OWNERSHIP
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on DATABASE"
    grant:
      privilege: OWNERSHIP
      objectType: DATABASE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on TABLE"
    grant:
      privilege: OWNERSHIP
      objectType: TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on EXTERNAL_TABLE"
    grant:
      privilege: OWNERSHIP
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on FILE_FORMAT"
    grant:
      privilege: OWNERSHIP
      objectType: FILE_FORMAT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
      grantOption: true
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on MATERIALIZED_VIEW"
    grant:
      privilege: OWNERSHIP
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  # Future Grants - should use SnowflakeFuturePermissionGrantBuilder
  - name: "SELECT on FUTURE EXTERNAL_TABLE (schema level)"
    grant:
      privilege: SELECT
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.<EXTERNAL TABLE>
      role: MY_ROLE
      future: true
    expectedBuilder: SnowflakeFuturePermissionGrantBuilder

  - name: "SELECT on FUTURE EXTERNAL_TABLE (database level)"
    grant:
      privilege: SELECT
      objectType: EXTERNAL_TABLE
      objectName: FOO.<EXTERNAL TABLE>
      role: MY_ROLE
      future: true
    expectedBuilder: SnowflakeFuturePermissionGrantBuilder

  - name: "SELECT on FUTURE TABLE"
    grant:
      privilege: SELECT
      objectType: TABLE
      objectName: FOO.BAR.<TABLE>
      role: MY_ROLE
      future: true
    expectedBuilder: SnowflakeFuturePermissionGrantBuilder

  # Future Ownership Grants - should use SnowflakeFutureOwnershipGrantBuilder
  - name: "OWNERSHIP on FUTURE FILE_FORMAT"
    grant:
      privilege: OWNERSHIP
      objectType: FILE_FORMAT
      objectName: FOO.BAR.<FILE_FORMAT>
      role: SYSADMIN
      grantOption: true
      future: true
    expectedBuilder: SnowflakeFutureOwnershipGrantBuilder

  - name: "OWNERSHIP on FUTURE MATERIALIZED_VIEW"
    grant:
      privilege: OWNERSHIP
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.<MATERIALIZED_VIEW>
      role: MY_ROLE
      future: true
    expectedBuilder: SnowflakeFutureOwnershipGrantBuilder

  # Account Permission Grants - should use SnowflakeAccountPermissionGrantBuilder
  - name: "APPLY PACKAGES POLICY on ACCOUNT"
    grant:
      privilege: APPLY PACKAGES POLICY
      objectType: ACCOUNT
      objectName: JUA64777
      role: SECURITYADMIN
      grantOption: true
    expectedBuilder: SnowflakeAccountPermissionGrantBuilder

  # Agent Grants
  - name: "USAGE on AGENT"
    grant:
      privilege: USAGE
      objectType: CORTEX_AGENT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on AGENT"
    grant:
      privilege: USAGE
      objectType: AGENT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on AGENT"
    grant:
      privilege: OWNERSHIP
      objectType: CORTEX_AGENT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "MODIFY on AGENT"
    grant:
      privilege: MODIFY
      objectType: CORTEX_AGENT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MONITOR on AGENT"
    grant:
      privilege: MONITOR
      objectType: CORTEX_AGENT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE AGENT on SCHEMA"
    grant:
      privilege: CREATE AGENT
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Semantic View Grants
  - name: "SELECT on SEMANTIC_VIEW"
    grant:
      privilege: SELECT
      objectType: SEMANTIC_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REFERENCES on SEMANTIC_VIEW"
    grant:
      privilege: REFERENCES
      objectType: SEMANTIC_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE SEMANTIC VIEW on SCHEMA"
    grant:
      privilege: CREATE SEMANTIC VIEW
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # ALL Grants - should use SnowflakeAllPermissionGrantBuilder
  - name: "SELECT on ALL TABLES"
    grant:
      privilege: SELECT
      objectType: TABLE
      objectName: FOO.BAR.<TABLE>
      role: MY_ROLE
      all: true
    expectedBuilder: SnowflakeAllPermissionGrantBuilder

  # Additional Table Privileges
  - name: "INSERT on TABLE"
    grant:
      privilege: INSERT
      objectType: TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "UPDATE on TABLE"
    grant:
      privilege: UPDATE
      objectType: TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "DELETE on TABLE"
    grant:
      privilege: DELETE
      objectType: TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "TRUNCATE on TABLE"
    grant:
      privilege: TRUNCATE
      objectType: TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REFERENCES on TABLE"
    grant:
      privilege: REFERENCES
      objectType: TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # View Grants
  - name: "SELECT on VIEW"
    grant:
      privilege: SELECT
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on VIEW"
    grant:
      privilege: OWNERSHIP
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  # Schema CREATE Privileges
  - name: "CREATE TABLE on SCHEMA"
    grant:
      privilege: CREATE TABLE
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE VIEW on SCHEMA"
    grant:
      privilege: CREATE VIEW
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE STAGE on SCHEMA"
    grant:
      privilege: CREATE STAGE
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE FUNCTION on SCHEMA"
    grant:
      privilege: CREATE FUNCTION
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE PROCEDURE on SCHEMA"
    grant:
      privilege: CREATE PROCEDURE
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE SEQUENCE on SCHEMA"
    grant:
      privilege: CREATE SEQUENCE
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE MATERIALIZED VIEW on SCHEMA"
    grant:
      privilege: CREATE MATERIALIZED VIEW
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Object-Level Privileges
  - name: "USAGE on FUNCTION"
    grant:
      privilege: USAGE
      objectType: FUNCTION
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on PROCEDURE"
    grant:
      privilege: USAGE
      objectType: PROCEDURE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on STAGE"
    grant:
      privilege: USAGE
      objectType: STAGE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "READ on STAGE"
    grant:
      privilege: READ
      objectType: STAGE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "WRITE on STAGE"
    grant:
      privilege: WRITE
      objectType: STAGE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on SEQUENCE"
    grant:
      privilege: USAGE
      objectType: SEQUENCE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on FILE_FORMAT"
    grant:
      privilege: USAGE
      objectType: FILE_FORMAT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Database-Level Privileges
  - name: "CREATE SCHEMA on DATABASE"
    grant:
      privilege: CREATE SCHEMA
      objectType: DATABASE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MODIFY on DATABASE"
    grant:
      privilege: MODIFY
      objectType: DATABASE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MONITOR on DATABASE"
    grant:
      privilege: MONITOR
      objectType: DATABASE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Warehouse Privileges
  - name: "USAGE on WAREHOUSE"
    grant:
      privilege: USAGE
      objectType: WAREHOUSE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OPERATE on WAREHOUSE"
    grant:
      privilege: OPERATE
      objectType: WAREHOUSE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MODIFY on WAREHOUSE"
    grant:
      privilege: MODIFY
      objectType: WAREHOUSE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MONITOR on WAREHOUSE"
    grant:
      privilege: MONITOR
      objectType: WAREHOUSE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Integration Privileges
  - name: "USAGE on INTEGRATION"
    grant:
      privilege: USAGE
      objectType: INTEGRATION
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Stream and Task Privileges
  - name: "SELECT on STREAM"
    grant:
      privilege: SELECT
      objectType: STREAM
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MONITOR on TASK"
    grant:
      privilege: MONITOR
      objectType: TASK
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OPERATE on TASK"
    grant:
      privilege: OPERATE
      objectType: TASK
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MONITOR on PIPE"
    grant:
      privilege: MONITOR
      objectType: PIPE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OPERATE on PIPE"
    grant:
      privilege: OPERATE
      objectType: PIPE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Additional Table Privileges
  - name: "REBUILD on TABLE"
    grant:
      privilege: REBUILD
      objectType: TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "EVOLVE SCHEMA on TABLE"
    grant:
      privilege: EVOLVE SCHEMA
      objectType: TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "APPLYBUDGET on TABLE"
    grant:
      privilege: APPLYBUDGET
      objectType: TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # External Table Additional Privileges
  - name: "INSERT on EXTERNAL_TABLE"
    grant:
      privilege: INSERT
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "UPDATE on EXTERNAL_TABLE"
    grant:
      privilege: UPDATE
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "DELETE on EXTERNAL_TABLE"
    grant:
      privilege: DELETE
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "TRUNCATE on EXTERNAL_TABLE"
    grant:
      privilege: TRUNCATE
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REFERENCES on EXTERNAL_TABLE"
    grant:
      privilege: REFERENCES
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REBUILD on EXTERNAL_TABLE"
    grant:
      privilege: REBUILD
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "EVOLVE SCHEMA on EXTERNAL_TABLE"
    grant:
      privilege: EVOLVE SCHEMA
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "APPLYBUDGET on EXTERNAL_TABLE"
    grant:
      privilege: APPLYBUDGET
      objectType: EXTERNAL_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Iceberg Table Privileges
  - name: "SELECT on ICEBERG_TABLE"
    grant:
      privilege: SELECT
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "INSERT on ICEBERG_TABLE"
    grant:
      privilege: INSERT
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "UPDATE on ICEBERG_TABLE"
    grant:
      privilege: UPDATE
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "DELETE on ICEBERG_TABLE"
    grant:
      privilege: DELETE
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "TRUNCATE on ICEBERG_TABLE"
    grant:
      privilege: TRUNCATE
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REFERENCES on ICEBERG_TABLE"
    grant:
      privilege: REFERENCES
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REBUILD on ICEBERG_TABLE"
    grant:
      privilege: REBUILD
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "EVOLVE SCHEMA on ICEBERG_TABLE"
    grant:
      privilege: EVOLVE SCHEMA
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "APPLYBUDGET on ICEBERG_TABLE"
    grant:
      privilege: APPLYBUDGET
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on ICEBERG_TABLE"
    grant:
      privilege: OWNERSHIP
      objectType: ICEBERG_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  # Event Table Privileges
  - name: "SELECT on EVENT_TABLE"
    grant:
      privilege: SELECT
      objectType: EVENT_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "INSERT on EVENT_TABLE"
    grant:
      privilege: INSERT
      objectType: EVENT_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on EVENT_TABLE"
    grant:
      privilege: OWNERSHIP
      objectType: EVENT_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  # View Additional Privileges
  - name: "INSERT on VIEW"
    grant:
      privilege: INSERT
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "UPDATE on VIEW"
    grant:
      privilege: UPDATE
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "DELETE on VIEW"
    grant:
      privilege: DELETE
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "TRUNCATE on VIEW"
    grant:
      privilege: TRUNCATE
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REFERENCES on VIEW"
    grant:
      privilege: REFERENCES
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REBUILD on VIEW"
    grant:
      privilege: REBUILD
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "EVOLVE SCHEMA on VIEW"
    grant:
      privilege: EVOLVE SCHEMA
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "APPLYBUDGET on VIEW"
    grant:
      privilege: APPLYBUDGET
      objectType: VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Materialized View Privileges
  - name: "SELECT on MATERIALIZED_VIEW"
    grant:
      privilege: SELECT
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "INSERT on MATERIALIZED_VIEW"
    grant:
      privilege: INSERT
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "UPDATE on MATERIALIZED_VIEW"
    grant:
      privilege: UPDATE
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "DELETE on MATERIALIZED_VIEW"
    grant:
      privilege: DELETE
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "TRUNCATE on MATERIALIZED_VIEW"
    grant:
      privilege: TRUNCATE
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REFERENCES on MATERIALIZED_VIEW"
    grant:
      privilege: REFERENCES
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REBUILD on MATERIALIZED_VIEW"
    grant:
      privilege: REBUILD
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "EVOLVE SCHEMA on MATERIALIZED_VIEW"
    grant:
      privilege: EVOLVE SCHEMA
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "APPLYBUDGET on MATERIALIZED_VIEW"
    grant:
      privilege: APPLYBUDGET
      objectType: MATERIALIZED_VIEW
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Schema Additional CREATE Privileges
  - name: "CREATE FILE FORMAT on SCHEMA"
    grant:
      privilege: CREATE FILE FORMAT
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE STREAM on SCHEMA"
    grant:
      privilege: CREATE STREAM
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "CREATE TASK on SCHEMA"
    grant:
      privilege: CREATE TASK
      objectType: SCHEMA
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Database Additional Privileges
  - name: "CREATE DATABASE ROLE on DATABASE"
    grant:
      privilege: CREATE DATABASE ROLE
      objectType: DATABASE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "IMPORTED PRIVILEGES on DATABASE"
    grant:
      privilege: IMPORTED PRIVILEGES
      objectType: DATABASE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "REFERENCE_USAGE on DATABASE"
    grant:
      privilege: REFERENCE_USAGE
      objectType: DATABASE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  # Integration Additional Privileges
  - name: "USE_ANY_ROLE on INTEGRATION"
    grant:
      privilege: USE_ANY_ROLE
      objectType: INTEGRATION
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on INTEGRATION"
    grant:
      privilege: OWNERSHIP
      objectType: INTEGRATION
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  # Additional Object Ownership Grants
  - name: "OWNERSHIP on FUNCTION"
    grant:
      privilege: OWNERSHIP
      objectType: FUNCTION
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on STAGE"
    grant:
      privilege: OWNERSHIP
      objectType: STAGE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on SEQUENCE"
    grant:
      privilege: OWNERSHIP
      objectType: SEQUENCE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on STREAM"
    grant:
      privilege: OWNERSHIP
      objectType: STREAM
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on TASK"
    grant:
      privilege: OWNERSHIP
      objectType: TASK
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on PIPE"
    grant:
      privilege: OWNERSHIP
      objectType: PIPE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on WAREHOUSE"
    grant:
      privilege: OWNERSHIP
      objectType: WAREHOUSE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  # Additional Object Privileges
  - name: "USAGE on SECRET"
    grant:
      privilege: USAGE
      objectType: SECRET
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on SECRET"
    grant:
      privilege: OWNERSHIP
      objectType: SECRET
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "USAGE on STREAMLIT"
    grant:
      privilege: USAGE
      objectType: STREAMLIT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on VOLUME"
    grant:
      privilege: USAGE
      objectType: VOLUME
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on VOLUME"
    grant:
      privilege: OWNERSHIP
      objectType: VOLUME
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "USAGE on INSTANCE"
    grant:
      privilege: USAGE
      objectType: INSTANCE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on INSTANCE"
    grant:
      privilege: OWNERSHIP
      objectType: INSTANCE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  # Policy Privileges
  - name: "APPLY on MASKING_POLICY"
    grant:
      privilege: APPLY
      objectType: MASKING_POLICY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on MASKING_POLICY"
    grant:
      privilege: OWNERSHIP
      objectType: MASKING_POLICY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "APPLY on PASSWORD_POLICY"
    grant:
      privilege: APPLY
      objectType: PASSWORD_POLICY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on PASSWORD_POLICY"
    grant:
      privilege: OWNERSHIP
      objectType: PASSWORD_POLICY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "APPLY on ROW_ACCESS_POLICY"
    grant:
      privilege: APPLY
      objectType: ROW_ACCESS_POLICY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on ROW_ACCESS_POLICY"
    grant:
      privilege: OWNERSHIP
      objectType: ROW_ACCESS_POLICY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "APPLY on SESSION_POLICY"
    grant:
      privilege: APPLY
      objectType: SESSION_POLICY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on SESSION_POLICY"
    grant:
      privilege: OWNERSHIP
      objectType: SESSION_POLICY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "APPLY on TAG"
    grant:
      privilege: APPLY
      objectType: TAG
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "READ on TAG"
    grant:
      privilege: READ
      objectType: TAG
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on TAG"
    grant:
      privilege: OWNERSHIP
      objectType: TAG
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  # Additional Object Types
  - name: "OPERATE on ALERT"
    grant:
      privilege: OPERATE
      objectType: ALERT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on ALERT"
    grant:
      privilege: OWNERSHIP
      objectType: ALERT
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "INSTANTIATE on CLASS"
    grant:
      privilege: INSTANTIATE
      objectType: CLASS
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on CLASS"
    grant:
      privilege: USAGE
      objectType: CLASS
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MODIFY on COMPUTE_POOL"
    grant:
      privilege: MODIFY
      objectType: COMPUTE_POOL
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MONITOR on COMPUTE_POOL"
    grant:
      privilege: MONITOR
      objectType: COMPUTE_POOL
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OPERATE on COMPUTE_POOL"
    grant:
      privilege: OPERATE
      objectType: COMPUTE_POOL
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "USAGE on COMPUTE_POOL"
    grant:
      privilege: USAGE
      objectType: COMPUTE_POOL
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on COMPUTE_POOL"
    grant:
      privilege: OWNERSHIP
      objectType: COMPUTE_POOL
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on DATABASE_ROLE"
    grant:
      privilege: OWNERSHIP
      objectType: DATABASE_ROLE
      objectName: FOO.BAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on DIRECTORY_TABLE"
    grant:
      privilege: OWNERSHIP
      objectType: DIRECTORY_TABLE
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "READ on IMAGE_REPOSITORY"
    grant:
      privilege: READ
      objectType: IMAGE_REPOSITORY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "WRITE on IMAGE_REPOSITORY"
    grant:
      privilege: WRITE
      objectType: IMAGE_REPOSITORY
      objectName: FOO.BAR.ZAR
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on NETWORK_POLICY"
    grant:
      privilege: OWNERSHIP
      objectType: NETWORK_POLICY
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "OWNERSHIP on NETWORK_RULE"
    grant:
      privilege: OWNERSHIP
      objectType: NETWORK_RULE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "MONITOR on RESOURCE_MONITOR"
    grant:
      privilege: MONITOR
      objectType: RESOURCE_MONITOR
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "MODIFY on RESOURCE_MONITOR"
    grant:
      privilege: MODIFY
      objectType: RESOURCE_MONITOR
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

  - name: "OWNERSHIP on ROLE"
    grant:
      privilege: OWNERSHIP
      objectType: ROLE
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakeOwnershipGrantBuilder

  - name: "MONITOR on USER"
    grant:
      privilege: MONITOR
      objectType: USER
      objectName: FOO
      role: MY_ROLE
    expectedBuilder: SnowflakePermissionGrantBuilder

